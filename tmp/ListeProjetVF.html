<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Bulma (UI framework) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">

  <!-- Font Awesome pour icônes -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <!-- Google Fonts : Montserrat (charte EPF) -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;900&display=swap" rel="stylesheet">

  <!-- Styles personnalisés -->
  <link rel="stylesheet" href="ListeProjetVF.css">

  <title>NOM_PLATEFORME </title>
</head>
<body>

<!-- Bandeau -->
<div id="bandeau">
    <div class="bandeau-texte editable-text">Nom_plateforme</div>
    <div class="bandeau-blanc"></div>
    <img src="EPF_blanc_RVB.png" alt="Logo EPF" class="logo-epf">
</div>
 
<!-- Filtres -->
<nav class="category-filters">
    <a href="">Portail d'Accueil</a>
    <a href="#Accueil" class="active" >Liste des Projets</a>
    <a src="">Page Projet</a>
</nav>

  <!-- ================= CONTENU PRINCIPAL ================= -->
  <main id="Accueil" class="container1 main-content" role="main">
    <!-- Intro : titre + description avant la barre de recherche -->
    <section class="intro">
      <h2 class="page-title">Liste des projets</h2>
      <p class="page-desc">
        Découvrez les projets réalisés par les étudiants de l'EPF Montpellier. Cette page centralise les réalisations par thématique et année.
        <br>Utilisez la recherche et les filtres thématiques pour trouver un projet.
      </p>

      <!-- Controls (Bulma) : recherche + tags -->
      <div class="controls">
        <!-- Champ recherche : limité en largeur pour ne pas trop s'étirer -->
        <div class="field" style="max-width:640px;">
          <label class="label is-sr-only" for="searchInput">Recherche</label>
          <div class="control has-icons-left">
            <input id="searchInput" class="input" type="search" placeholder="Rechercher un projet..." aria-label="Rechercher un projet" />
            <span class="icon is-left"><i class="fas fa-search"></i></span>
          </div>
        </div>

        <!-- Tags (pills) : garder data-tag et classes pour le script -->
       <!-- ---------- Barre de tags avec flèches de scroll ---------- -->
      <div class="tags-scroll-wrapper" aria-label="Filtrer par thématiques">
        <!-- flèche gauche -->
        <button id="tagsScrollLeft" class="tags-scroll-arrow" aria-label="Faire défiler les tags vers la gauche" type="button">
          <i class="fas fa-chevron-left" aria-hidden="true"></i>
        </button>

        <!-- zone scrollable contenant les tags (ne pas modifier l'id) -->
        <div id="tagsBar" class="tags-scroll-area" role="list" tabindex="0">
          <!-- exemple de tags (conserver data-tag) -->
          <button class="tag-pill tag is-light" data-tag="__all__" aria-pressed="true">Tous les projets <span class="tag-remove" style="display:none">×</span></button>

          <button class="tag-pill tag is-light" data-tag="Informatique">Informatique</button>
          <button class="tag-pill tag is-light" data-tag="IA">IA</button>
          <button class="tag-pill tag is-light" data-tag="Robotique">Robotique</button>
          <button class="tag-pill tag is-light" data-tag="Web">Web</button>
          <button class="tag-pill tag is-light" data-tag="Éco">Éco</button>
          <button class="tag-pill tag is-light" data-tag="Design">Design</button>
          <button class="tag-pill tag is-light" data-tag="Data">Data</button>
          <button class="tag-pill tag is-light" data-tag="Machine Learning">Machine Learning</button>
          <button class="tag-pill tag is-light" data-tag="Environnement">Environnement</button>
          <button class="tag-pill tag is-light" data-tag="Electronique">Electronique</button>
          <button class="tag-pill tag is-light" data-tag="Energie">Energie</button>
          
          <!-- ajoute d'autres tags ici si besoin -->
        </div>

        <!-- flèche droite -->
        <button id="tagsScrollRight" class="tags-scroll-arrow" aria-label="Faire défiler les tags vers la droite" type="button">
          <i class="fas fa-chevron-right" aria-hidden="true"></i>
        </button>
      </div>

      </div>
    </section>

    <!-- ================= GRILLE DES PROJETS ================= -->
    <!-- IMPORTANT : j'utilise une grille CSS pour garder la taille des cartes stable même s'il n'y a qu'une carte visible -->
    <section class="projects-grid" aria-label="Liste des projets">

      <!-- Exemple : carte 1 -->
      <article class="project-card card" data-tags="Environnement">
        <div class="card-image">
          <figure class="image is-4by3 project-media">
            <img src="Timecap2.JPEG" alt="TIMECAP">
          </figure>
        </div>
        <div class="card-content project-body">
          <div class="content">
            <div class="project-meta level is-mobile" style="align-items:center;">
              <div class="level-left">
                <span class="tag project-tag tag is-rounded">Environnement</span>
              </div>
              <div class="level-right">
                <time datetime="2025-09-01" class="is-size-7 has-text-grey">Juil 2025</time>
              </div>
            </div>

            <h2 class="project-title title is-5">TIMECAP</h2>
            <p class="project-desc">La capsule temporelle de l'EPF.</p>

            <div class="project-footer">
              <a class="btn button is-white" href="#">Voir le projet</a>
              <div class="media-indicator">3 images</div>
            </div>
          </div>
        </div>
      </article>

      <!-- Exemple : carte 2 -->
      <article class="project-card card" data-tags="Informatique,IA">
        <div class="card-image">
          <figure class="image is-4by3 project-media">
            <img src="Assolink.JPEG" alt="ASSOLINK">
          </figure>
        </div>
        <div class="card-content project-body">
          <div class="content">
            <div class="project-meta level is-mobile">
              <div class="level-left">
                <span class="tag project-tag tag is-rounded">Informatique</span>
              </div>
              <div class="level-right">
                <time datetime="2025-07-12" class="is-size-7 has-text-grey">Juil 2025</time>
              </div>
            </div>

            <h2 class="project-title title is-5">ASSOLINK</h2>
            <p class="project-desc">La vie associative de l'EPF via une application. BLA BLA BLA BLA BLA BLA BLA BLA BLA BLA BLA BLA BLA BLA BLA BLA BLA BLA BLA BLA BLA BLA BLA BLA</p>

            <div class="project-footer">
              <a class="btn button is-white" href="#">Voir le projet</a>
              <div class="media-indicator">1 vidéo</div>
            </div>
          </div>
        </div>
      </article>

      <!-- Exemple : carte 3 -->
      <article class="project-card card" data-tags="Energie">
        <div class="card-image">
          <figure class="image is-4by3 project-media">
            <img src="Hydrogene.JPG" alt="HYDROGENE">
          </figure>
        </div>
        <div class="card-content project-body">
          <div class="content">
            <div class="project-meta level is-mobile">
              <div class="level-left">
                <span class="tag project-tag tag is-rounded">Energie</span>
              </div>
              <div class="level-right">
                <time datetime="2025-07-12" class="is-size-7 has-text-grey">Juil 2025</time>
              </div>
            </div>

            <h2 class="project-title title is-5">HYDROGENE</h2>
            <p class="project-desc">Création d'un banc de test pour l'hydrogène.</p>

            <div class="project-footer">
              <a class="btn button is-white" href="#">Voir le projet</a>
              <div class="media-indicator">1 vidéo</div>
            </div>
          </div>
        </div>
      </article>

      <!-- Exemple : carte 4 -->
      <article class="project-card card" data-tags="Electronique">
        <div class="card-image">
          <figure class="image is-4by3 project-media">
            <img src="LOCKERBILLARD.JPG" alt="LOCKERBILLARD">
          </figure>
        </div>
        <div class="card-content project-body">
          <div class="content">
            <div class="project-meta level is-mobile">
              <div class="level-left">
                <span class="tag project-tag tag is-rounded">Electronique</span>
              </div>
              <div class="level-right">
                <time datetime="2025-09-01" class="is-size-7 has-text-grey">Juil 2025</time>
              </div>
            </div>

            <h2 class="project-title title is-5">LOCKERBILLARD</h2>
            <p class="project-desc">Un système de verrouillage intelligent pour billard.</p>

            <div class="project-footer">
              <a class="btn button is-white" href="#">Voir le projet</a>
              <div class="media-indicator">3 images</div>
            </div>
          </div>
        </div>
      </article>

      <!-- Exemple : carte 5 -->
      <article class="project-card card" data-tags="Informatique">
        <div class="card-image">
          <figure class="image is-4by3 project-media">
            <img src="Upschool.JPEG" alt="UPSCHOOL">
          </figure>
        </div>
        <div class="card-content project-body">
          <div class="content">
            <div class="project-meta level is-mobile">
              <div class="level-left">
                <span class="tag project-tag tag is-rounded">Informatique</span>
              </div>
              <div class="level-right">
                <time datetime="2025-07-12" class="is-size-7 has-text-grey">Juil 2025</time>
              </div>
            </div>

            <h2 class="project-title title is-5">UPSCHOOL</h2>
            <p class="project-desc">Trouver la bonne école selon son profil.</p>

            <div class="project-footer">
              <a class="btn button is-white" href="#">Voir le projet</a>
              <div class="media-indicator">1 vidéo</div>
            </div>
          </div>
        </div>
      </article>

    </section>

    <!-- message "aucun résultat" (créé dynamiquement si besoin) -->
    <div id="noResultsMessage" aria-live="polite"></div>
  </main>

  <!-- ================= FOOTER ================= -->
  <!--<footer class="footer has-background-light" style="padding:28px 0; margin-top:28px;">
    <div class="container has-text-centered">
      <p>&copy; 2025 EPF — Plateforme de valorisation des projets étudiants</p>
    </div>
  </footer>

    -- FOOTER -->
  <footer class="footer epf-footer">

      <!-- PRE-FOOTER -->
      <div class="prefooter container">
          <div class="prefooter-left">
              <img src="EPF_100ans_couleur-crop.png" alt="EPF Logo">
          </div>

          <div class="prefooter-right">
              <h4>Suivez-nous</h4>
              <ul class="social-links">
                  <li><a href="https://www.facebook.com/EPF.engineering.school" target="_blank">Facebook</a></li>
                  <li><a href="https://www.tiktok.com/@epf_ingenieur" target="_blank">TikTok</a></li>
                  <li><a href="https://www.instagram.com/epfengineeringschool" target="_blank">Instagram</a></li>
                  <li><a href="https://www.linkedin.com/school/epf-ecole-d'ingénieur-e-s/" target="_blank">LinkedIn</a></li>
                  <li><a href="https://www.youtube.com/user/epfingenieurs" target="_blank">YouTube</a></li>
              </ul>
          </div>
      </div>

      <!-- MENTIONS -->
      <div class="footer-bottom container">
          <p>@ 2025 EPF</p>
          <ul class="footer-links">
              <li><a href="/contactez-nous">Contact</a></li>
              <li><a href="/mentions-legales">Mentions légales</a></li>
              <li><a href="/donnees-personnelles">Données personnelles</a></li>
              <li><a href="/presse">Presse</a></li>
          </ul>
      </div>

      <!-- PARTNERS -->
      <div class="partner-logos container">
          <img src="CGE.png" alt="CGE">
          <img src="cti-logo-cmjn.png" alt="CTI">
          <img src="EESPIG.jpeg" alt="EESPIG">
          <img src="eur-ace_0.png" alt="EUR-ACE">
          <img src="logo-qualiopi.jpeg" alt="Qualiopi">
          <img src="concours_avenir_logo.jpeg" alt="Concours Avenir">
          <img src="Label_CampusFrance_Bienv.jpg" alt="Bienvenue en France">
      </div>
  </footer>

  <!-- ================= SCRIPTS (conservés & compatibles) ================= -->
  <script>
    
  /* ============================
    Script : filtrage + coloration dynamique des tag-pills
    - Les pastilles des cartes restent colorées (applyTagColors)
    - Les tag-pills de la barre sont neutres au départ
    - Quand on active une pill, on lui ajoute la classe color-* correspondante
    ============================ */

  /* --- Récupérations DOM --- */
  const searchInput = document.getElementById('searchInput');
  const tagsBar = document.getElementById('tagsBar');
  const projectCards = Array.from(document.querySelectorAll('.project-card'));
  let selectedTags = new Set();

  const normalize = s => String(s || '').trim().toLowerCase();

  /* --- MAPPING thématique -> classe CSS (à garder synchronisé avec ton CSS) --- */
  const TAG_CLASS_MAP = {
    'informatique': 'color-informatique',
    'ia': 'color-ia',
    'robotique': 'color-robotique',
    'web': 'color-web',
    'éco': 'color-eco',
    'eco': 'color-eco',
    'design': 'color-design',
    'data': 'color-data',
    'machine learning': 'color-ml',
    'ml': 'color-ml',
    'environnement': 'color-environnement',
    'electronique': 'color-electronique',
    'énergie': 'color-energie',
    'energie': 'color-energie'
  };

  /* helper : retourne la classe color-* pour un tag (string) */
  function getColorClassForTag(tagValue) {
    if (!tagValue) return 'color-default';
    const key = normalize(tagValue);
    return TAG_CLASS_MAP[key] || 'color-default';
  }

  /* -----------------------
    Coloration des pastilles sur les CARTES (inchangée)
    ----------------------- */
  function applyTagColorsToCards() {
    document.querySelectorAll('.project-card').forEach(card => {
      // recherche le span de la carte qui contient le tag (project-tag ou .tag)
      let tagSpan = card.querySelector('.project-tag') || card.querySelector('.tag');
      let tagText = '';

      if (tagSpan && tagSpan.textContent.trim()) {
        tagText = tagSpan.textContent.trim();
      } else {
        const raw = (card.getAttribute('data-tags') || '').split(',')[0] || '';
        tagText = raw.trim();
      }

      const colorClass = getColorClassForTag(tagText);

      if (tagSpan) {
        // retirer anciennes classes color-*
        Array.from(tagSpan.classList).forEach(c => {
          if (c.startsWith('color-')) tagSpan.classList.remove(c);
        });
        tagSpan.classList.add(colorClass);
      }
    });
  }

  /* --- Filtrage (recherche + tags) --- */
  function cardMatchesFilters(card, searchTerm, selectedTagsSet) {
    const titleEl = card.querySelector('.project-title');
    const descEl = card.querySelector('.project-desc');

    const title = normalize(titleEl ? titleEl.textContent : '');
    const desc = normalize(descEl ? descEl.textContent : '');

    const searchMatch = !searchTerm || title.includes(searchTerm) || desc.includes(searchTerm);

    const dataTagsRaw = card.getAttribute('data-tags') || '';
    const cardTags = new Set(
      dataTagsRaw.split(',')
        .map(t => t.trim())
        .filter(Boolean)
        .map(t => t.toLowerCase())
    );

    if (selectedTagsSet.size === 0) return searchMatch;

    for (const t of selectedTagsSet) {
      if (cardTags.has(t.toLowerCase())) return searchMatch;
    }
    return false;
  }

  function refreshProjectsView() {
    const searchTerm = normalize(searchInput.value || '');
    let visibleCount = 0;
    projectCards.forEach(card => {
      if (cardMatchesFilters(card, searchTerm, selectedTags)) {
        card.style.display = '';
        visibleCount++;
      } else {
        card.style.display = 'none';
      }
    });

    const noResultEl = document.getElementById('noResultsMessage');
    if (noResultEl) noResultEl.textContent = visibleCount === 0 ? "Aucun projet ne correspond aux filtres." : "";
  }

  /* -----------------------
    Gérer la couleur de la pill au clic
    ----------------------- */
  function setPillColorState(pill, shouldApply) {
    const tagVal = pill.getAttribute('data-tag') || '';
    const colorClass = getColorClassForTag(tagVal);

    // enlever anciennes classes color-*
    Array.from(pill.classList).forEach(c => {
      if (c.startsWith('color-')) pill.classList.remove(c);
    });

    if (shouldApply) {
      pill.classList.add(colorClass);
    } else {
      // rien à ajouter : pill reste neutre (active garde juste le style de bord/gras)
    }
  }

  /* --- Gestion des clics sur la barre de tags --- */
  tagsBar.addEventListener('click', event => {
    const btn = event.target.closest('.tag-pill');
    if (!btn) return;

    const tagValue = btn.getAttribute('data-tag');
    if (!tagValue) return;

    // Si "Tous les projets" -> clear sélection + retirer colors sur toutes les pills
    if (tagValue === '__all__') {
      selectedTags.clear();
      document.querySelectorAll('.tag-pill').forEach(p => {
        p.classList.remove('active');
        p.setAttribute('aria-pressed','false');
        // retirer toute classe color-*
        Array.from(p.classList).forEach(c => { if (c.startsWith('color-')) p.classList.remove(c); });
      });
      // activer visuellement 'Tous' (neutre)
      btn.classList.add('active');
      btn.setAttribute('aria-pressed','true');
      refreshProjectsView();
      return;
    }

    const normalized = normalize(tagValue);
    if (selectedTags.has(normalized)) {
      // désélectionner
      selectedTags.delete(normalized);
      btn.classList.remove('active');
      btn.setAttribute('aria-pressed','false');
      // retirer la couleur associée sur la pill
      setPillColorState(btn, false);
    } else {
      // sélectionner
      selectedTags.add(normalized);
      btn.classList.add('active');
      btn.setAttribute('aria-pressed','true');
      // appliquer la couleur correspondante à la pill
      setPillColorState(btn, true);
    }

    // gérer l'état du bouton "Tous les projets"
    const allBtn = tagsBar.querySelector('.tag-pill[data-tag="__all__"]');
    if (selectedTags.size > 0) {
      if (allBtn) { allBtn.classList.remove('active'); allBtn.setAttribute('aria-pressed','false'); }
    } else {
      if (allBtn) { allBtn.classList.add('active'); allBtn.setAttribute('aria-pressed','true'); }
    }

    refreshProjectsView();
  });

  /* --- Suppression d'un tag via la croix × --- */
  tagsBar.addEventListener('click', (event) => {
    const removeBtn = event.target.closest('.tag-remove');
    if (!removeBtn) return;

    const tagBtn = removeBtn.closest('.tag-pill');
    if (!tagBtn) return;

    const tagValue = tagBtn.getAttribute('data-tag');
    if (tagValue === '__all__') return;

    // retirer du DOM
    tagBtn.remove();
    selectedTags.delete(tagValue.toLowerCase());

    // si aucun tag sélectionné -> ré-activer 'Tous les projets'
    if (selectedTags.size === 0) {
      const allBtn = tagsBar.querySelector('.tag-pill[data-tag="__all__"]');
      if (allBtn) { allBtn.classList.add('active'); allBtn.setAttribute('aria-pressed','true'); }
    }

    refreshProjectsView();
  });

  /* --- Recherche instantanée --- */
  searchInput.addEventListener('input', () => refreshProjectsView());

  /* --- Initialisation au chargement --- */
  document.addEventListener('DOMContentLoaded', () => {
    // colorer les tags dans les cartes (toujours)
    applyTagColorsToCards();

    // IMPORTANT : NE PAS colorer toutes les pills ici (on veut qu'elles restent neutres)
    // Si tu veux pré-colorer une pill spécifique en fonction d'un état serveur, c'est ici qu'il faudrait le faire.

    // rafraîchir la vue initiale
    refreshProjectsView();
  });

  /* =====================================================
   Scroll horizontal pour la barre de tags avec flèches
   Doit être exécuté après que #tagsBar existe dans le DOM
   ===================================================== */

  (function initTagsScroller() {
    const scrollArea = document.getElementById('tagsBar'); // zone scrollable (déjà utilisée par le script)
    const leftBtn = document.getElementById('tagsScrollLeft');
    const rightBtn = document.getElementById('tagsScrollRight');

    if (!scrollArea || !leftBtn || !rightBtn) return;

    // montant du scroll à effectuer à chaque clic (taille visible - some padding)
    function getScrollStep() {
      return Math.round(scrollArea.clientWidth * 0.6); // 60% de la zone visible
    }

    // met à jour l'état des flèches (disabled si pas de défilement possible)
    function updateArrowsState() {
      const maxScrollLeft = scrollArea.scrollWidth - scrollArea.clientWidth;
      leftBtn.disabled = scrollArea.scrollLeft <= 5;
      rightBtn.disabled = scrollArea.scrollLeft >= (maxScrollLeft - 5);
    }

    // clic flèche droite
    rightBtn.addEventListener('click', () => {
      scrollArea.scrollBy({ left: getScrollStep(), behavior: 'smooth' });
      // updateArrowsState() sera appelé lors de l'event 'scroll'
    });

    // clic flèche gauche
    leftBtn.addEventListener('click', () => {
      scrollArea.scrollBy({ left: -getScrollStep(), behavior: 'smooth' });
    });

    // mettre à jour les flèches pendant le scroll
    scrollArea.addEventListener('scroll', () => {
      // tiny debounce pour perf
      window.requestAnimationFrame(updateArrowsState);
    });

    // navigation clavier lorsque l'élément est focusé
    scrollArea.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowRight') {
        e.preventDefault();
        scrollArea.scrollBy({ left: 150, behavior: 'smooth' });
      } else if (e.key === 'ArrowLeft') {
        e.preventDefault();
        scrollArea.scrollBy({ left: -150, behavior: 'smooth' });
      }
    });

    // au chargement / resize : régler l'état initial
    window.addEventListener('load', updateArrowsState);
    window.addEventListener('resize', updateArrowsState);

    // optionnel : si tu veux que le click sur une pill recentre le tag dans la vue
    scrollArea.addEventListener('click', (e) => {
      const pill = e.target.closest('.tag-pill');
      if (!pill) return;
      // recentrer la pill dans la zone visible
      const pillLeft = pill.offsetLeft;
      const pillWidth = pill.offsetWidth;
      const areaCenter = (scrollArea.clientWidth / 2) - (pillWidth / 2);
      scrollArea.scrollTo({ left: pillLeft - areaCenter, behavior: 'smooth' });
    });

    // init
    updateArrowsState();
  })();




  </script>
</body>
</html>
